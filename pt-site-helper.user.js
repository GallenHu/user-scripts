// ==UserScript==
// @name             PT助手
// @description      PT站助手:后台签到,复制链接
// @version          0.2
// @match            *://*.m-team.cc/*
// @match            *://pterclub.com/*
// @match            *://ourbits.club/*
// @match            *://hdhome.org/*
// @match            *://lemonhd.org/*
// @match            *://pthome.net/*
// @match            *://www.beitai.pt/*
// @grant            window.onurlchange
// @grant            GM_registerMenuCommand
// @grant            GM_xmlhttpRequest
// @grant            GM_setClipboard
// @grant            GM_setValue
// @grant            GM_getValue
// @grant            GM_notification
// @namespace        https://github.com/GallenHu/user-scripts
// @homepage         https://github.com/GallenHu
// @author           Gallen
// @icon             https://i.loli.net/2020/02/11/sluFx1NIW9zCLS6.png
// @license          MIT
// @require          https://cdn.staticfile.org/jquery/1.12.2/jquery.min.js
// @updateURL        https://fastly.jsdelivr.net/gh/gallenhu/user-scripts@release/pt-site-helper.user.js
// @downloadURL      https://fastly.jsdelivr.net/gh/gallenhu/user-scripts@release/pt-site-helper.user.js
// ==/UserScript==
/* eslint-disable */ /* spell-checker: disable */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["pt-site-helper"]=e():t["pt-site-helper"]=e()}(this,(()=>(()=>{"use strict";var t={};const e=new class{constructor(){this.location={},this.host="",this.origin="",this.location=window.location,this.host=this.location.host,this.origin=this.location.origin}isDomain(t){return this.host.endsWith(t)}};const n=new class{get(t,e){GM_xmlhttpRequest({method:"GET",url:t,headers:{"User-agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.41"},onload:function(t){e(t)}})}postByForm(t,e,n){GM_xmlhttpRequest({method:"POST",url:t,data:new URLSearchParams(e).toString(),headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(t){n(t)}})}postByJson(t,e,n){GM_xmlhttpRequest({method:"POST",url:t,data:JSON.stringify(e),headers:{"Content-Type":"application/x-www-form-urlencoded"},onload:function(t){n(t)}})}},o=e.host,i=e.origin,a=document.querySelector("body"),r=a.innerText.indexOf("下一页")>-1||a.innerText.indexOf("下一頁")>-1,l=e.location.pathname.indexOf("detail")>-1,s=o.indexOf("pter")>-1;function d(){const t=GM_getValue("highlightFreePosts");if(console.log("highlightFreePosts",t),t){var e=$(".pro_free"),n=$(".pro_free2up"),o="background: rgb(255, 222, 144, 1) !important";$.each(e,((t,e)=>{s?$(e).parent().parent().attr("style",o):$(e).parent().attr("style",o)})),$.each(n,((t,e)=>{$(e).parent().attr("style",o)}))}}function c(){const t=GM_getValue("enlargeThumbnail");if(console.log("enlargeThumbnail",t),t){e="280px",null===(n=document.querySelector(".ant-spin-container table thead th:nth-child(2)"))||void 0===n||n.setAttribute("style","width: 500px"),$(".ant-image .torrent-list__thumbnail").css({width:"auto",height:e})}var e,n}function u(){const t=GM_getValue("openInNewTab");console.log("openInNewTab:",t),t&&$("table.torrentname a[href*='detail']").attr("target","_blank")}return function(){function t(){GM_notification({text:"请刷新页面",title:"提示",onclick:()=>window.location.reload()})}GM_registerMenuCommand("启用高亮Free",(()=>{GM_setValue("highlightFreePosts",1),d()})),GM_registerMenuCommand("禁用高亮Free",(()=>{GM_setValue("highlightFreePosts",0),t()})),GM_registerMenuCommand("启用缩略图放大",(()=>{GM_setValue("enlargeThumbnail",1),c()})),GM_registerMenuCommand("禁用缩略图放大",(()=>{GM_setValue("enlargeThumbnail",0),t()})),GM_registerMenuCommand("启用新标签页打开",(()=>{GM_setValue("openInNewTab",1),u()})),GM_registerMenuCommand("禁用新标签页打开",(()=>{GM_setValue("openInNewTab",0),t()}))}(),setTimeout((()=>{var t,e,o;r&&(d(),c(),u()),l&&function(){var t,e,n,o,a,r,l;if(null===(t=$("a:contains('[IPv4+https]')"))||void 0===t?void 0:t.length)return a=$("a:contains('[IPv4+https]')"),r=a.attr("href"),l=0===r.indexOf("http")?r:i+r,a.parent().parent().prepend(["<span>IPv4+https：</span>",'<input class="my-downloadurl" value="'+l+'" style="width:700px">',"<br><br>"].join("")),r=(a=$("a:contains('[IPv4]')")).attr("href"),l=i+r,a.parent().parent().prepend(["<span>IPv4：</span>",'<input class="my-downloadurl" value="'+l+'" style="width:700px">',"<br><br>"].join("")),void $("body").on("click",".my-downloadurl",(function(){const t=$(this);t[0].select(),GM_setClipboard(t.val(),"text"),GM_notification({text:"链接已复制",title:"提示",timeout:1500})}));(null===(e=$("a:contains('[HTTP]')"))||void 0===e?void 0:e.length)?function(){var t=$("a:contains('[HTTP]')"),e=t.attr("href"),n=0===e.indexOf("http")?e:i+e,o=t.parent();o.prepend(["<span>HTTP：</span>",'<input class="my-downloadurl" value="'+n+'" style="width:700px">',"<br><br>"].join("")),e=(t=$("a:contains('[HTTPS]')")).attr("href"),n=i+e,(o=t.parent()).prepend(["<span>HTTPS：</span>",'<input class="my-downloadurl" value="'+n+'" style="width:700px">',"<br><br>"].join("")),$("body").on("click",".my-downloadurl",(function(){const t=$(this);t[0].select(),GM_setClipboard(t.val(),"text"),GM_notification({text:"链接已复制",title:"提示",timeout:1500})}))}():(null===(n=$("a:contains('[下载地址]')"))||void 0===n?void 0:n.length)?function(){var t=$("a:contains('[下载地址]')"),e=t.attr("href"),n=0===e.indexOf("http")?e:i+e;t.parent().prepend(['<input id="downloadurl" value="'+n+'" style="width:700px">',"<br><br>"].join("")),$("body").on("click","#downloadurl",(function(){const t=$(this);t[0].select(),GM_setClipboard(t.val(),"text"),GM_notification({text:"链接已复制",title:"提示",timeout:1500})}))}():(null===(o=$("td:contains('种子链接')"))||void 0===o?void 0:o.length)&&function(){var t=$("td:contains('种子链接')").next(),e=t.find("a").attr("href"),n=0===e.indexOf("http")?e:i+"/"+e;t.prepend(['<input id="downloadurl" value="'+n+'" style="width:700px">',"<br><br>"].join("")),$("body").on("click","#downloadurl",(function(){const t=$(this);t[0].select(),GM_setClipboard(t.val(),"text"),GM_notification({text:"链接已复制",title:"提示",timeout:1500})}))}()}(),t=$("#nav_block a.faqlink"),e=$('#outer a[href="index.php?action=addbonus"]'),o=$("#sign_in a"),(null==t?void 0:t.length)&&n.get(t.attr("href"),(()=>{t.remove()})),e&&n.get(e.attr("href"),(()=>{e.remove()})),o&&o.click()}),1e3),null===window.onurlchange&&window.addEventListener("urlchange",(()=>{})),t=t.default})()));